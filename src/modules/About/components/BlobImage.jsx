import { motion, useCycle } from "framer-motion"
import { useState } from "react"

const BlobImage = ({ src, alt }) => {

    const [mousePosition, setMousePosition] = useState({ x: 0, y: 0 })
    const [isHovering, toggleHovering] = useCycle(false, true)

    const handleMouseMove = (e) => {
        const { left, top } = e.target.getBoundingClientRect()
        setMousePosition({
            x: e.clientX - left - 250,
            y: e.clientY - top - 200
        })
    }

    return(
        <div 
            className="relative w-full h-full flex overflow-hidden"
            onMouseMove={handleMouseMove}
            onMouseEnter={toggleHovering}
            onMouseLeave={toggleHovering}    
        >
            <div className="w-full h-full">
                <img 
                    alt={`${alt}-grayscale`}
                    src={src}
                    className="w-full h-full rounded-sm grayscale object-cover opacity-80"
                />
            </div>
            <div 
                className={`absolute w-full h-full inset-0 duration-200 transition-[opacity] ${isHovering ? "opacity-100" : "opacity-0"}`}
                style={{
                    clipPath: `url(#blobClipPath)`,
                    top: `${mousePosition.y}px`,
                    left: `${mousePosition.x}px`,
                }}
            >
                <img 
                    alt={`${alt}-normal`}
                    src={src}
                    className="absolute w-full h-full inset-0 object-cover"
                    style={{
                        top: `${-mousePosition.y}px`,
                        left: `${-mousePosition.x}px`,
                    }}
                />
                <svg width="0" height="0">
                    <defs>
                        <clipPath id="blobClipPath" clipPathUnits="useSpaceOnUse" transform="scale(1 1)">
                            <motion.path d="M200.702 351.566C199.493 350.576 190.539 339.192 189 339L188.825 338.86C186.76 337.207 175.684 328.342 174 327.5C162.471 321.735 166.407 321.285 155.896 314.412C145.745 307.776 133.373 301.86 124.54 293.354C116.338 285.455 105.178 270.971 116.006 260.143C122.807 253.342 141.629 254.394 138.363 240.106C134.59 223.599 121.165 217.718 108.491 208.565C104.838 205.926 100.427 204.196 96.6172 201.7C93.9142 199.929 91.5025 198.095 88.8711 196.273C83.5921 192.618 80.1876 187.367 77.7854 181.662C74.0016 172.676 90.1246 167.931 93.4631 162.088C101.223 148.508 82.3098 129.597 73.645 120.934L73.4717 120.76C66.0054 113.294 59.0189 105.473 51.5322 97.9859C43.8496 90.3032 35.0708 83.8115 28.3403 75.2115C21.3655 66.2992 14.5693 57.6102 12.2916 46.2216C11.1145 40.3364 14.291 33.1864 20.4551 31.4252C22.426 30.8621 26.3086 32.712 28.3403 33.0023C32.1855 33.5516 35.6847 34.8841 39.1941 36.5738C50.24 41.8922 60.571 47.1647 70.2712 54.7562C90.7157 70.7563 148.94 116.089 161.276 68.1148C162.823 62.0997 164.064 57.0721 162.714 50.9992C161.783 46.8087 157.488 43.8797 156.267 39.7279C151.482 23.4601 177.181 27.8756 186.184 30.1265C190.514 31.2088 194.901 31.8311 199.079 33.4661C204.992 35.7798 209.494 39.9236 214.989 42.882C220.156 45.6644 224.407 50.5633 229.089 54.1069C233.409 57.3756 237.978 60.2933 242.03 63.9402C250.673 71.7184 260.793 76.3165 271.484 80.6384C283.653 85.5578 295.103 89.7501 307.988 92.3271C315.414 93.8122 321.913 92.7794 329.093 90.4717C336.161 88.1998 343.811 88.6596 351.078 89.8224C357.394 90.8329 363.396 94.1648 368.24 98.2642C372.842 102.158 380.282 107.902 382.156 114.035C383.362 117.982 384.856 121.682 385.866 125.723C386.863 129.712 386.88 133.631 388.603 137.458C392.769 146.718 396.978 153.653 403.399 161.624C412.204 172.554 426.282 179.676 438.326 186.301C456.548 196.322 478.355 207.22 478.355 231.014C478.355 239.489 478.354 246.163 473.346 253.279C469.897 258.18 461.615 262.782 455.72 263.437C448.333 264.258 440.727 265.988 433.27 265.988C427.818 265.988 421.347 267.95 417.593 272.018C413.857 276.065 415.047 282.488 415.784 287.278C416.402 291.295 419.135 294.62 419.912 298.503C420.505 301.468 422.387 305.044 424.086 307.548C431.828 318.956 448.36 330.806 443.104 347.159C440.783 354.38 435.289 361.015 427.89 362.791C420.833 364.484 414.903 371.746 407.203 372.021C390.779 372.608 375.348 366.739 359.799 362.42C352.956 360.519 346.771 357.488 339.761 355.972C332.828 354.473 324.377 354.918 317.636 356.993C305.42 360.751 301.063 378.496 287.162 379.489C268.374 380.831 247.081 374.941 230.388 366.594C223.382 363.091 215.952 360.275 209.051 356.529C206.413 355.096 202.977 353.427 200.702 351.566Z"  />
                            <motion.path d="M68.4159 225.263C72.8356 231.647 80.7705 235.077 88.4537 235.931C92.6715 238.04 92.4433 240.438 90.5409 243.863C88.7953 247.005 74.2654 242.494 70.9206 241.59C62.7829 239.391 57.0439 232.796 50.0015 228.834C43.0523 224.925 38.6182 219.148 33.8136 212.971C31.9323 210.552 29.5547 201.395 33.5353 200.216C39.7067 198.387 47.4327 201.647 52.0888 205.457C58.3872 210.61 63.8005 218.596 68.4159 225.263Z" />
                            <motion.path d="M434.569 154.528C437.817 157.185 445.831 161.624 449.969 161.624C456.824 161.624 463.074 161.567 466.017 154.945C468.581 149.178 461.291 141.22 457.483 137.412C455.131 135.061 452.335 133.532 449.551 131.985C446.001 130.013 443.043 125.957 440.785 122.569C436.315 115.864 435.57 102.047 428.261 97.9859C423.619 95.4068 417.437 87.4886 413.047 92.9764C409.177 97.8141 417.85 108.92 418.242 114.22C418.619 119.313 419.912 123.928 419.912 129.109C419.912 133.467 422.118 140.793 424.921 144.091C427.906 147.603 430.904 151.529 434.569 154.528Z" />
                            <motion.path d="M446.629 293.169C446.629 296.012 445.63 305.457 449 305.878C449 308.019 460.995 314.988 463.327 315.247C468.195 315.788 476.009 319.723 480.86 317.567C486.508 315.056 493.384 313.921 493.384 305.878C493.384 300.894 490.212 294.175 486.287 291.035C482.415 287.937 477.604 290.2 472.975 290.2C469.73 290.2 467.268 288.583 464.162 287.695C461.961 287.067 459.3 284.356 457.065 284.356C450.106 284.356 446.629 285.573 446.629 293.169Z" />
                        </clipPath>
                    </defs>
                </svg>
            </div>
        </div>
    )
} 

export default BlobImage
